# TravelFun 商城系統技術文件

## 1. 整體架構

TravelFun 商城系統採用前後端分離架構，提供完整的電子商務功能，為用戶提供便捷的線上購物體驗。

### 系統架構

- **前後端分離**：採用 Vue + Vite 前端與 Django 後端分離的架構
- **資料夾結構**：
  - 前端：`src/views/front/Mall/`（主要視圖和組件）
  - 後端：`DjangoAdmin2/shopping_system/`（後端模型和 API）

### 資料流向

- 前端從 API 獲取商品數據並顯示給用戶
- 用戶操作（如添加商品到購物車、提交訂單）通過 API 發送到後端
- 後端處理業務邏輯後，更新數據庫並返回結果給前端

### 程式碼組織

- **後端模組化**：使用 Django 模型定義數據結構，視圖處理業務邏輯
- **前端元件化**：將商城界面拆分為多個功能性組件
- **本地數據緩存**：使用 JSON 檔案在前端存儲商品數據，提高加載速度

### 部署架構

- 開發環境：Vite 開發伺服器 + Django 開發伺服器
- 生產環境：支援容器化部署
- 資料存儲：使用關系型資料庫存儲商品和訂單數據

## 2. 前端開發工具

### 核心框架與平台

- **Vue 3**：使用 Vue 3 框架開發前端界面
- **Vite**：使用 Vite 作為開發與構建工具
- **TypeScript**：提供類型安全性和代碼提示

### UI 組件與樣式

- **自定義 UI 組件**：自行開發商城專用組件
- **Tailwind CSS**：用於快速構建響應式界面
- **CSS 動畫**：提供流暢的過渡效果

### 開發環境工具

- **ESLint**：檢查和規範代碼風格
- **Prettier**：自動格式化代碼
- **Chrome DevTools**：用於調試前端界面

### 包管理與構建工具

- **npm/pnpm**：管理前端依賴包
- **Vite 構建配置**：優化前端資源加載
- **環境變數管理**：區分開發和生產環境配置

## 3. 前端開發技術

### 核心技術

- **Vue 3 Composition API**：使用 `<script setup>` 語法組織功能邏輯
- **Vue Router**：實現商城頁面路由，如商品列表、詳情頁等
- **TypeScript 類型系統**：定義商品、訂單等數據模型的類型
- **響應式設計**：使用媒體查詢適配不同設備

### 狀態管理與數據處理

- **Ref 與 Reactive**：管理商城前端的響應式狀態
- **Axios**：處理 AJAX 請求，與後端 API 通信
- **本地數據緩存**：使用 JSON 文件緩存部分商品數據
- **LocalStorage**：保存購物車數據和用戶偏好

### 用戶界面與體驗

- **輪播組件**：展示商城推薦商品和促銷活動
- **商品卡片**：以卡片形式展示商品信息
- **商品過濾器**：根據類別、價格範圍過濾商品
- **分頁系統**：對大量商品數據進行分頁顯示

### 性能優化

- **圖片懶加載**：優化商品圖片加載性能
- **按需加載**：僅加載當前視圖需要的組件
- **緩存機制**：緩存商品數據減少重複請求
- **節流和防抖**：優化搜索和過濾操作的性能

### 購物流程

- **購物車管理**：添加、移除、更新購物車商品
- **訂單流程**：商品選擇、確認、支付流程
- **地址管理**：用戶收貨地址的管理界面
- **訂單狀態跟踪**：顯示訂單處理的不同階段

## 4. 後端開發工具

### 核心框架

- **Django**：後端核心框架
- **Django REST Framework**：構建 RESTful API
- **數據庫 ORM**：使用 Django ORM 操作數據庫

### API 與身份驗證

- **JWT 認證**：實現無狀態的用戶認證
- **權限控制**：基於用戶角色的 API 訪問控制
- **跨域資源共享**：處理前後端跨域問題

### 資料處理與整合

- **序列化器**：轉換 Django 模型為 JSON 格式
- **異步任務處理**：使用 `tasks.py` 處理耗時操作
- **數據驗證**：API 輸入驗證確保數據完整性

### 開發與調試工具

- **Django Debug Toolbar**：分析和優化數據查詢
- **日誌系統**：記錄系統運行狀態和錯誤
- **單元測試**：使用 `tests.py` 測試關鍵功能

### 部署工具

- **Docker**：容器化部署
- **Nginx**：Web 伺服器和反向代理
- **Gunicorn**：Python WSGI HTTP 伺服器

## 5. 後端開發技術

### 核心技術

- **MVC 架構**：使用 Django 的模型-視圖-控制器模式
- **RESTful API**：實現符合 REST 規範的 API
- **CRUD 操作**：完整的創建、讀取、更新、刪除操作

### 資料模型與資料庫操作

- **7 個主要模型**：
  - Product（商品）
  - ProductReview（商品評論）
  - Carousel（輪播圖）
  - CategoryDisplay（分類展示）
  - RecommendedProduct（推薦商品）
  - Order（訂單）
  - OrderItem（訂單項目）
- **關係設計**：一對多、多對多關係設計
- **模型方法**：實現業務邏輯，如庫存更新、價格計算等

### API 實現與安全性

- **ViewSets**：實現資源的 CRUD 操作
- **CSRF 保護**：防止跨站請求偽造攻擊
- **輸入驗證**：驗證和清理用戶輸入
- **錯誤處理**：統一的 API 錯誤響應格式

### 業務邏輯實現

- **購物車操作**：添加、更新、移除購物車商品
- **訂單處理**：創建訂單、更新訂單狀態
- **庫存管理**：訂單創建時自動更新商品庫存
- **支付流程**：支持多種支付方式的處理流程

### 性能與可擴展性

- **數據庫優化**：使用索引提高查詢性能
- **緩存機制**：緩存熱門商品數據
- **批量處理**：批量更新數據減少數據庫操作
- **資源限制**：API 請求限流防止濫用

## 6. 重點功能

### 商品管理

- **商品展示**：多視圖展示商品信息
- **商品分類**：按類別組織商品
- **商品搜索**：按關鍵字和屬性搜索商品
- **商品推薦**：首頁推薦、熱門商品、新品上市

### 購物流程

- **購物車管理**：實時添加、移除、更新購物車
- **訂單處理**：創建訂單、確認訂單、取消訂單
- **支付整合**：支持多種支付方式
- **訂單跟踪**：跟踪訂單處理狀態（待付款、已付款、已出貨、已完成）

### 用戶體驗

- **商品評論系統**：用戶可對已購商品進行評論和評分
- **商品對比**：比較不同商品的功能和價格
- **個性化推薦**：基於用戶偏好推薦商品
- **瀏覽歷史**：記錄用戶的商品瀏覽歷史

### 促銷功能

- **輪播廣告**：首頁輪播展示促銷信息
- **特惠活動**：限時折扣、特價商品展示
- **優惠券系統**：支持各種優惠券和折扣碼
- **捆綁銷售**：相關商品的組合推薦

### 後台管理

- **商品管理**：添加、編輯、刪除商品
- **訂單管理**：查看和處理訂單
- **庫存監控**：監控商品庫存，低庫存提醒
- **銷售報表**：銷售統計和分析報告
