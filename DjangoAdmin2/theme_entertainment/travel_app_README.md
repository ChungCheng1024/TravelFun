# TravelFun 旅遊系統技術文件

## 1. 整體架構

TravelFun 旅遊系統採用前後端分離架構，為用戶提供景點查詢、地圖導航和旅遊規劃等功能，打造完整的旅遊體驗。

### 系統架構

- **前後端分離**：採用 Vue + Vite 前端與 Django 後端分離的架構
- **資料夾結構**：
  - 前端：`src/views/front/Travel/`（主要視圖和組件）
  - 後端：`DjangoAdmin2/travel_app/`（後端模型和 API）

### 資料流向

- 前端從 API 獲取景點數據並在地圖和列表中展示
- 用戶操作（如景點篩選、路徑規劃）通過 API 發送至後端
- 後端處理業務邏輯後，更新數據庫並返回結果給前端

### 程式碼組織

- **後端模組化**：使用 Django 模型定義數據結構，視圖處理業務邏輯
- **前端元件化**：將旅遊界面拆分為多個功能性組件
- **地圖整合**：利用 Leaflet 實現互動地圖功能

### 部署架構

- 開發環境：Vite 開發伺服器 + Django 開發伺服器
- 生產環境：支援容器化部署
- 資料存儲：使用關系型資料庫存儲景點和旅遊計劃數據

## 2. 前端開發工具

### 核心框架與平台

- **Vue 3**：使用 Vue 3 框架開發前端界面
- **Vite**：使用 Vite 作為開發與構建工具
- **TypeScript**：提供類型安全性和代碼提示

### UI 組件與樣式

- **Naive UI**：使用 Naive UI 組件庫提供基礎組件
- **自定義 UI 組件**：自行開發旅遊專用組件
- **SVG 台灣地圖**：自定義 SVG 台灣地圖展示各縣市
- **CSS/SCSS**：使用嵌套樣式和變量簡化樣式開發

### 地圖相關工具

- **Leaflet**：開源地圖庫，用於顯示互動地圖
- **OpenStreetMap**：提供地圖底圖和數據
- **地圖標記器**：自定義地圖標記樣式和功能

### 開發環境工具

- **ESLint**：檢查和規範代碼風格
- **Prettier**：自動格式化代碼
- **Chrome DevTools**：用於調試前端界面

### 包管理與構建工具

- **npm/pnpm**：管理前端依賴包
- **Vite 構建配置**：優化前端資源加載
- **環境變數管理**：區分開發和生產環境配置

## 3. 前端開發技術

### 核心技術

- **Vue 3 Composition API**：使用 `<script setup>` 組織邏輯
- **Vue Router**：實現路由管理，支持不同城市的景點瀏覽
- **TypeScript 類型系統**：定義景點、路徑等數據結構
- **響應式設計**：使用媒體查詢適配不同設備

### 地圖與空間功能

- **Leaflet 地圖整合**：顯示互動式地圖和景點標記
- **自定義標記**：根據不同狀態顯示不同標記樣式
- **路徑規劃**：計算並展示最佳旅遊路線
- **地理數據處理**：處理經緯度和地理坐標數據

### 狀態管理與數據處理

- **Ref 與 Reactive**：管理前端響應式狀態
- **Axios**：處理 API 請求，獲取景點數據
- **數據過濾**：根據縣市、類別等條件篩選景點
- **LocalStorage**：儲存用戶的景點收藏和偏好設置

### 用戶界面與體驗

- **交互式台灣地圖**：直觀選擇縣市
- **景點卡片**：以卡片形式展示景點信息
- **預覽模態框**：查看景點詳情
- **麵包屑導航**：顯示頁面層級結構

### 性能優化

- **懶加載**：按需加載景點數據和圖片
- **按需渲染**：僅渲染視圖範圍內的景點標記
- **數據緩存**：緩存常用景點數據減少重複請求
- **節流和防抖**：優化搜索和地圖交互操作

## 4. 後端開發工具

### 核心框架

- **Django**：後端核心框架
- **Django REST Framework**：構建 RESTful API
- **數據庫 ORM**：使用 Django ORM 操作數據庫

### API 與身份驗證

- **REST API**：提供標準化的數據接口
- **權限控制**：使用 `AllowAny` 提供公開訪問
- **API 測試工具**：提供 API 測試界面

### 資料處理與整合

- **序列化器**：使用 Django REST Framework 序列化器處理數據
- **路徑規劃算法**：實現複雜的旅遊路徑規劃
- **地理空間計算**：計算景點間距離和路徑

### 開發與調試工具

- **Django Debug Toolbar**：分析和優化數據查詢
- **日誌系統**：記錄系統運行狀態和錯誤
- **單元測試**：使用 `tests.py` 測試關鍵功能

### 部署工具

- **Docker**：容器化部署
- **Nginx**：Web 伺服器和反向代理
- **Gunicorn**：Python WSGI HTTP 伺服器

## 5. 後端開發技術

### 核心技術

- **MVC 架構**：使用 Django 的模型-視圖-控制器模式
- **RESTful API**：實現符合 REST 規範的 API
- **ViewSets**：使用 DRF ViewSets 提供 API 端點

### 資料模型與資料庫操作

- **4 個主要模型**：
  - `Travel`：景點信息，包含名稱、描述、地址、坐標等
  - `TravelClass`：景點分類信息
  - `Counties`：縣市信息
  - `Taiwan`：台灣地區信息，包含區域和城鎮
- **多重關係**：使用 ForeignKey 建立模型間的關聯
- **查詢優化**：使用 order_by 和 filter 優化資料庫查詢

### API 實現與數據處理

- **序列化器**：定義五種序列化器處理不同模型的數據轉換
- **視圖集**：實現不同資源的 CRUD 操作
- **分頁**：實現數據分頁顯示，提高前端性能
- **查詢篩選**：支持基於多種條件的數據篩選

### 路徑規劃算法

- **哈弗辛距離計算**：計算兩點間的球面距離
- **二優化算法**：優化旅行路徑
- **模擬退火算法**：進一步優化路徑規劃
- **複雜度優化**：減少計算複雜度，提高響應速度

### 性能與可維護性

- **數據庫索引**：優化查詢性能
- **代碼組織**：清晰的代碼結構和命名規範
- **錯誤處理**：全面的錯誤捕獲和處理機制
- **API 版本控制**：支持 API 版本管理

## 6. 重點功能

### 景點搜索與瀏覽

- **全台灣地圖導覽**：通過互動地圖瀏覽全台灣景點
- **縣市景點瀏覽**：按縣市分類瀏覽景點
- **關鍵字搜索**：根據名稱搜索景點
- **分類篩選**：根據景點類型篩選

### 地圖功能

- **互動式地圖**：使用 Leaflet 提供流暢的地圖體驗
- **景點標記**：在地圖上顯示景點位置
- **地圖控制**：縮放、平移等操作
- **定位功能**：顯示用戶當前位置

### 旅遊規劃

- **行程規劃**：規劃旅遊行程和路線
- **最佳路徑**：計算景點間的最佳遊覽路徑
- **路徑顯示**：在地圖上直觀顯示規劃路徑
- **時間估算**：估算景點間的行程時間

### 景點管理

- **景點收藏**：收藏喜愛的景點
- **個人景點清單**：管理個人收藏的景點
- **景點評分**：評價和查看景點評分
- **景點詳情**：查看景點詳細資訊，包括開放時間、門票信息等

### 用戶功能

- **個人收藏**：保存喜愛的景點
- **行程分享**：分享規劃好的行程
- **旅遊歷史**：記錄曾經瀏覽的景點
- **個性化推薦**：基於用戶偏好推薦景點
